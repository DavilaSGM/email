<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Correos Grupo Armenta</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  input, button { padding: 8px; margin: 5px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  th { background-color: #f4f4f4; }
  #contador { margin: 10px 5px; font-weight: bold; }
</style>
</head>
<body>

<h2>Correos Grupo Armenta</h2>
<input type="text" id="buscar" placeholder="Escribe el nombre del empleado..." />
<button id="btnAll">Mostrar todo</button>
<button id="btnClear">Limpiar</button>
<div id="contador"></div>

<table id="tabla" aria-live="polite">
  <thead>
    <tr>
      <th>Empleado</th>
      <th>Correo SGM MERCADOTECNIA</th>
      <th>Correo GRUPO ARMENTA</th>
      <th>Correo GMAIL</th>
      <th>Correo ESO QUIERO</th>
      <th>Correo LO QUIERO</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const SHEET_ID = "1V1THreu-HWI4eIXtM22bxgFTi_AQNNguuOxNf-xBEHU";
const GID = "0"; // Reemplaza con el GID real de la pestaÃ±a "Email"
const URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${GID}`;

let filas = [];
const tbody = document.querySelector("#tabla tbody");
const inputBuscar = document.getElementById("buscar");
const btnAll = document.getElementById("btnAll");
const btnClear = document.getElementById("btnClear");
const contador = document.getElementById("contador");

fetch(URL)
  .then(res => res.text())
  .then(csv => {
    filas = csv.trim().split("\n").map(line => line.split(","));
  })
  .catch(err => console.error("Error al cargar CSV:", err));

function mostrarFilas(filtro = "") {
  tbody.innerHTML = "";
  const filtroLower = filtro.toLowerCase();
  let encontrados = 0;

  filas.slice(1).forEach(fila => {
    if (!filtro || fila[0].toLowerCase().includes(filtroLower)) {
      const tr = document.createElement("tr");
      fila.forEach(col => {
        const td = document.createElement("td");
        td.textContent = col.trim() !== "" ? col : "No aplica";
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
      encontrados++;
    }
  });

  if (encontrados === 0 && filtro) {
    const tr = document.createElement("tr");
    const numCols = filas[0].length;
    for (let i = 0; i < numCols; i++) {
      const td = document.createElement("td");
      td.textContent = "N/A";
      tr.appendChild(td);
    }
    tbody.appendChild(tr);
  }

  contador.textContent = encontrados > 0 
    ? `Mostrando ${encontrados} resultado(s)` 
    : (filtro ? "Sin resultados" : "");
}

inputBuscar.addEventListener("input", e => {
  mostrarFilas(e.target.value);
});

btnAll.addEventListener("click", () => {
  inputBuscar.value = "";
  mostrarFilas();
});

btnClear.addEventListener("click", () => {
  inputBuscar.value = "";
  tbody.innerHTML = "";
  contador.textContent = "";
});
</script>

</body>
</html>
